---
title: "Mental_Imagery_analysis"
output: html_document
---

```{r}
library(tidyverse)

library(rstan)
# set cores to use to the total number of cores (minimally 4)
options(mc.cores = max(parallel::detectCores(), 4))
# save a compiled version of the Stan model file
rstan_options(auto_write = TRUE)

library(brms)

# install faintr with 
install.packages("HDInterval")
devtools::install_github('michael-franke/bayes_mixed_regression_tutorial/faintr', build_vignettes = TRUE)
library(faintr)


set.seed(123)

```



```{r}
# your code here
(data <- read_csv("C:/Users/leado/XP_Lab/Mental_Imagery_Experiment/data/results.csv"))
data %>% glimpse()


```


```{r}
# + native_language = languages, + the language test results
(s_data <- select(data, experiment_id, trial_name, id, type, response, RT, language, native_language, foreign_language, foreign_dominance, speaking_native, listening_native, writing_native, speaking_foreign, listening_foreign, writing_foreign, reading_time, listening_time, speaking_time, learning_time))

```



```{r}
#here we change the types of the variables
m_data <- mutate(s_data, trial_name = factor(trial_name), type = factor(type), exp_language= factor(language), native_language = factor(native_language), foreign_language= factor(foreign_language), foreign_dominance = factor(foreign_dominance), subject_id = as.numeric(experiment_id), response = as.numeric(response), experiment_id = NULL)

m_data
```


```{r}
#here we calculate the mean response for trial and the real task (not important)
(s_data <- group_by(m_data, trial_name) %>% summarise(overall_mean = mean(response)))
```

```{r}
#here we calculate the mean for the different types of the real task
(s_data2 <- group_by(m_data, type) %>% filter(trial_name=="ratingScaleTask") %>% summarise(type_mean=mean(response)))
```

```{r}
#check if the foreign or native language is used in this experiment and add the new column
m_data$language_equality <- identical(m_data[["exp_language"]],m_data[["native_language"]])
m_data

#filter the data for our prerequisites
m_data %>% filter(foreign_dominance == 'no', identical(m_data[["foreign_language"]],m_data[["native_language"]]) == FALSE, foreign_language == 'English'| foreign_language == 'German', native_language == 'English'| native_language == 'German')
m_data
```


```{r}
#here we calculate the mean for the different types of the real task and group by language equality (set foreign_language == native_language)
(s_data3 <- group_by(m_data, type, language_equality) %>% filter(trial_name=="ratingScaleTask") %>% summarise(type_lang_mean=mean(response)))

```


```{r}
#brms model creation 

fit_sc1 <- brm(
formula = Mean ~ language_equality + type,
data = s_data3,
family = cumulative("logit")
)

```

